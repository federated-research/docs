import { Steps, Cards, Callout } from "nextra/components";

# Run analysis with All In One Demo

<Steps>

## Install Funnel

<Cards>

<Cards.Card

title="How to install Funnel"
href='/five_safes_tes/TES/install_funnel'
arrow

/>

</Cards>
## In the All In One repository change these settings:

Change these settings in the **_.env_** file:

```yaml copy filename=".env"

// Turn off Demo mode to execute analysis:
DemoMode = false

// Allow Keycloak to not require https:
KeyCloakDemoMode = true

// Set UseTESK to true:
UseTESK = true

// Set TesAPIUrl to the URL where the TES API executing agent is hosted. e.g Funnel or TES-K:
TesAPIUrl=http://<HostName>:8000/v1/tasks

// Output bucket prefix for the TES executing agent to write outputs to, default is s3 bucket prefix:
TesOutputBucketPrefix=s3://


```

<Callout type="info">
  Restart the containers to apply the new configuration.
</Callout>

<Callout type="warning">
There is a known issue where `KeyCloakDemoMode = true` in `.env` but KeyCloak stills requires HTTPS when logging in locally with Docker.
We are currently working on a fix and in the meantime, it can be resolved by the following steps:

1. Access the Keycloak console at `http://localhost:8085`, using the admin credentials:

```yaml copy
Username: admin
Password: admin
```

2. Navigate to each Realm: `DARE-Control`, `DARE-TRE`, `DARE-Egress` by clicking on the Realm name in the left-hand side.
3. Access `Realm settings` under `Configure` section on the left-hand side menu.
4. Choose `None` from the `Require SSL` dropdown.
5. Click on the `Save` button.

</Callout>
</Steps>

## Submit a TES message

Once Funnel is running and the All In One is up and configured, you can submit a TES payload to the Submission Layer.

<Cards>

<Cards.Card

title="Run Hello World"
href='/submission/tasks/quickstart'
arrow

/>

<Cards.Card

title="Run analysis workflow"
href='/submission/tasks/run_analysis'
arrow

/>

</Cards>
